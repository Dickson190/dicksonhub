<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile</title>
    <link rel="stylesheet" href="load.css">
    <link rel="stylesheet" href="profile.css">
    <link rel="stylesheet" href="sidenav.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>
  <div class="mobile-container">
    <!-- Side Navigation -->
    <div id="sidenav" class="sidenav">
      <a href="javascript:void(0)" class="closebtn" onclick="toggleNav()">&times;</a>
      <a href="app.html">Home</a>
      <a href="earn.html">Offerwall</a>
      <a href="task.html">Task</a>
      <a href="bean.html" class="active">Upgrade Account</a>
      <a href="shop.html">Shop</a>
      <a href="news.html">New Features/Updates</a>
      <a href="withdraw.html">Withdraw</a>
      <a href="whistory.html">Withdrawal History</a>
      <a href="about.html">About Us</a>
    </div>

    <a href="javascript:void(0);" class="icon" onclick="toggleNav()">
      <i class="fa fa-bars"></i>
    </a>

    <div class="container">
        <h1>User Profile</h1>
        <form id="profileForm">
            <div class="form-group">
                <label for="username">Username:</label>
                <input type="text" id="username" disabled required>
            </div>
            <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" id="password" disabled required>
            </div>
            <div class="form-group">
                <label for="uniqueCode">Unique Code:</label>
                <input type="text" id="uniqueCode" disabled required>
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" required>
            </div>
            <div class="form-group">
                <label for="firstName">First Name:</label>
                <input type="text" id="firstName" required>
            </div>
            <div class="form-group">
                <label for="lastName">Last Name:</label>
                <input type="text" id="lastName" required>
            </div>
            <div class="form-group">
                <label for="age">Age:</label>
                <select id="age" required>
                    <option value="">Select Age</option>
                    <!-- Populate ages dynamically -->
                </select>
            </div>
            <div class="form-group">
                <label for="gender">Gender:</label>
                <select id="gender" required>
                    <option value="">Select Gender</option>
                    <option value="Male">Male</option>
                    <option value="Female">Female</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <div class="form-group">
                <label for="state">State:</label>
                <input type="text" id="state" required>
            </div>
            <div class="form-group">
                <label for="phoneNumber">Phone Number:</label>
                <input type="tel" id="phoneNumber" required>
            </div>
            <div class="form-group">
                <label for="network">Network:</label>
                <select id="network" required>
                    <option value="">Select Network</option>
                    <option value="MTN">MTN</option>
                    <option value="Glo">Glo</option>
                    <option value="Airtel">Airtel</option>
                    <option value="9mobile">9mobile</option>
                </select>
            </div>
            <div class="form-group">
                <label for="bankName">Bank Name:</label>
                <input type="text" id="bankName" required>
            </div>
            <div class="form-group">
                <label for="accountName">Account Name:</label>
                <input type="text" id="accountName" required>
            </div>
            <div class="form-group">
                <label for="accountNumber">Account Number:</label>
                <input type="text" id="accountNumber" required>
            </div>
            <div class="form-group">
                <label for="lga">LGA:</label>
                <input type="text" id="lga" required>
            </div>
            <button type="submit">Submit</button>
        </form>
    </div>

    <div class="loader" id="loader">
        <div class="cooking">
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="pot"></div>
        </div>
    </div>

    <script src="load.js"></script>
    <script src="sidenav.js"></script>
    
  <script> document.addEventListener('DOMContentLoaded', function () {
  const profileForm = document.getElementById('profile-form');
  const notificationBox = document.getElementById('notification');
  const notificationMessage = document.getElementById('notification-message');
  const notificationButton = document.getElementById('notification-button');
  const progressBar = document.getElementById('progress-bar');

  const usernameField = document.getElementById('username');
  const passwordField = document.getElementById('password');
  const uniqueCodeField = document.getElementById('uniqueCode');
  const phoneNumberField = document.getElementById('phoneNumber');
  const lgaField = document.getElementById('lga');
  const accountNameField = document.getElementById('accountName');
  const accountNumberField = document.getElementById('accountNumber');
  const bankNameField = document.getElementById('bankName');
  const ageField = document.getElementById('age');
  const stateField = document.getElementById('state');

  let usersData = [];

  const apiUrls = [
    'https://sheetdb.io/api/v1/op1g6xcfghwt6',
    'https://sheetdb.io/api/v1/yqjwwro2ogq7u'
  ];

  function fetchData(apiUrl) {
    return fetch(apiUrl)
      .then(response => response.json())
      .catch(error => {
        console.error('Error fetching user data from', apiUrl, ':', error);
        return null;
      });
  }

  function loadData() {
    return Promise.all(apiUrls.map(fetchData))
      .then(results => {
        usersData = results.flat();
        console.log('Fetched user data:', usersData);
      })
      .catch(error => {
        showNotification('An error occurred while fetching user data. Please try again.');
      });
  }

  function showNotification(message, isSuccess = false) {
    notificationMessage.textContent = message;
    notificationBox.className = `notification ${isSuccess ? 'success' : 'error'}`;
    notificationBox.style.display = 'block';
    notificationButton.style.display = isSuccess ? 'inline-block' : 'none';
    if (isSuccess) {
      notificationButton.addEventListener('click', () => {
        notificationBox.style.display = 'none';
      });
    } else {
      setTimeout(() => {
        notificationBox.style.display = 'none';
      }, 3000);
    }
  }

  function showProgressBar(message) {
    notificationMessage.textContent = message;
    notificationBox.className = 'notification';
    notificationBox.style.display = 'block';
    progressBar.style.display = 'block';
  }

  function hideProgressBar() {
    notificationBox.style.display = 'none';
    progressBar.style.display = 'none';
  }

  function populateFieldsFromLocalStorage() {
    const username = localStorage.getItem('username');
    const password = localStorage.getItem('password');
    const uniqueCode = localStorage.getItem('uniqueCode');
    const phoneNumber = localStorage.getItem('phoneNumber');
    const lga = localStorage.getItem('lga');
    const accountName = localStorage.getItem('accountName');
    const accountNumber = localStorage.getItem('accountNumber');
    const bankName = localStorage.getItem('bankName');
    const age = localStorage.getItem('age');
    const state = localStorage.getItem('state');

    if (username) {
      usernameField.value = username;
    }
    if (password) {
      passwordField.value = password;
    }
    if (uniqueCode) {
      uniqueCodeField.value = uniqueCode;
    }
    if (phoneNumber) {
      phoneNumberField.value = phoneNumber;
    }
    if (lga) {
      lgaField.value = lga;
    }
    if (accountName) {
      accountNameField.value = accountName;
    }
    if (accountNumber) {
      accountNumberField.value = accountNumber;
    }
    if (bankName) {
      bankNameField.value = bankName;
    }
    if (age) {
      ageField.value = age;
    }
    if (state) {
      stateField.value = state;
    }

    return { username, password, uniqueCode, phoneNumber, lga, accountName, accountNumber, bankName, age, state };
  }

  function storeAdditionalDataToLocalStorage(user) {
    if (user['uniqueCode']) {
      localStorage.setItem('uniqueCode', user['uniqueCode']);
      uniqueCodeField.value = user['uniqueCode'];
    }
    if (user['phoneNumber']) {
      localStorage.setItem('phoneNumber', user['phoneNumber']);
      phoneNumberField.value = user['phoneNumber'];
    }
    if (user['lga']) {
      localStorage.setItem('lga', user['lga']);
      lgaField.value = user['lga'];
    }
    if (user['accountName']) {
      localStorage.setItem('accountName', user['accountName']);
      accountNameField.value = user['accountName'];
    }
    if (user['accountNumber']) {
      localStorage.setItem('accountNumber', user['accountNumber']);
      accountNumberField.value = user['accountNumber'];
    }
    if (user['bankName']) {
      localStorage.setItem('bankName', user['bankName']);
      bankNameField.value = user['bankName'];
    }
    if (user['age']) {
      localStorage.setItem('age', user['age']);
      ageField.value = user['age'];
    }
    if (user['state']) {
      localStorage.setItem('state', user['state']);
      stateField.value = user['state'];
    }
  }

  function retrieveAndVerifyUserData(username) {
    const user = usersData.find(user => user['name'] === username);
    if (user) {
      storeAdditionalDataToLocalStorage(user);
      showNotification('Data restored successfully.', true);
    } else {
      showNotification('User data could not be verified.');
    }
  }

  function initializeProfile() {
    const { username, password, uniqueCode, phoneNumber, lga, accountName, accountNumber, bankName, age, state } = populateFieldsFromLocalStorage();

    if (!uniqueCode || !phoneNumber || !lga || !accountName || !accountNumber || !bankName || !age || !state) {
      showProgressBar('Restoring data. Please wait...');
      loadData().then(() => {
        retrieveAndVerifyUserData(username);
        hideProgressBar();
      });
    }
  }

  initializeProfile();
});
</script>
</body>
</html>
<!-- API keys -->
<!-- https://sheetdb.io/api/v1/05zo2s09gbz5x -->
<!-- https://sheetdb.io/api/v1/mw7e3hg45k2qt -->